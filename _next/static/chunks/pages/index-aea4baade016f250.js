(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(7240)}])},7240:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Y}});var s,i,n,o=a(5893),r=a(9008),l=a.n(r),h=a(7294),c=a(6999),u=a.n(c),d=a(5385);(i||(i={})).MACHINE_BODY="slotMachine.glb",(s=n||(n={})).BODY_BUMP="/textures/bodyBump.jpg",s.BODY_BUMP_NORMAL="/textures/bodyBumpNormal.png",s.WIN_REEL="/textures/reel.png",s.WIN_REEL_NORMAL="/textures/reelNormal.png",s.SHADOW_MAP="/textures/shadowMap.jpg",s.STONE="/textures/stone.jpg",s.STONE_NORMAL="/textures/stoneNormal.jpg",s.FABRIC_NORMAL="/textures/fabricNormal.jpg";class m{constructor(e,t,a){this.bodyBumpTextureTask=e.addTextureTask("body bump task",t+n.BODY_BUMP),this.bodyBumpNormalTextureTask=e.addTextureTask("body bump normal task",t+n.BODY_BUMP_NORMAL),this.winReelTextureTask=e.addTextureTask("body bump task",t+n.WIN_REEL),this.winReelNormalTextureTask=e.addTextureTask("body bump normal task",t+n.WIN_REEL_NORMAL),this.shadowMapTextureTask=e.addTextureTask("Shadow mask task",t+n.SHADOW_MAP),this.floorTextureTask=e.addTextureTask("floor task",t+n.STONE),this.floorNormalTextureTask=e.addTextureTask("floor normal task",t+n.STONE_NORMAL),this.fabricNormalTextureTask=e.addTextureTask("fabric normal task",t+n.FABRIC_NORMAL),this.gameTileTextureTasks=a.recommendedGames.map(a=>e.addTextureTask("Game tile task","".concat(t).concat(a.textureUrl))),e.addMeshTask("pm task","",t+"/models/",i.MACHINE_BODY)}}class g extends d.FreeCamera{constructor(e,t){super("Camera",new d.Vector3(0,2,10),e),this.setTarget(new d.Vector3(0,.4,0)),this.fovMode=g.FOVMODE_HORIZONTAL_FIXED,this.fov=1,this.inertia=.4,this.attachControl(t,!0),this.minZ=.45,this.checkCollisions=!0,this.applyGravity=!0,this.ellipsoid=new d.Vector3(1,1,1)}}a(2001);var p=a(990);let f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new d.Vector4(.3333333333333333*e,.25*t,.3333333333333333*(e+1),.25*(t+1))},w=f(0,0),x=f(0,1),T=f(0,2),b=f(0,3),y=f(1,0),P=f(1,1),C=f(1,2),k=f(1,3),_=f(2,3),M=f(2,2),v=f(2,1),O=[w,y,x,P,T,C,b,k],R=()=>O[Math.floor(Math.random()*O.length)];class N{spin(){let e=0;return"left"==this.reelPosition&&(e=0),"middle"==this.reelPosition&&(e=.75),"right"==this.reelPosition&&(e=1.5),p.ZP.to(this.cylinders.map(e=>e.rotation),9,{delay:e,y:"+= ".concat(2*Math.PI*15+Math.PI/2),ease:"back.inOut(0.8)",onUpdate:()=>{this.cylinders.forEach(e=>{let t=Math.floor(e.rotation.y/(2*Math.PI));if(e.rotation.y%Math.PI*2>Math.PI/4&&t<=15)e.hasDisplayed=!0;else if(!0==e.hasDisplayed&&e.name.match(/_segment_1/)){let a=R();15==t&&e.name.match(/segment_1/)&&(a="left"===this.reelPosition?_:"middle"===this.reelPosition?M:"right"===this.reelPosition&&this.hasWon?v:R()),e.material.albedoTexture.uOffset=a.x,e.material.albedoTexture.vOffset=a.y,e.material.bumpTexture.uOffset=a.x,e.material.bumpTexture.vOffset=a.y,e.hasDisplayed=!1}})}})}constructor(e,t=S.globalWinReelWidth,a,s,i="left",n){this.cylinders=[];let o=S.globalWinReelWidth,r=S.globalReelDiameter,l=S.globalReelSegments,h=[];"left"!==i&&"middle"!==i&&"right"!==i&&console.error("Reel position name assigned out of scope"),this.hasWon=n,this.reelPosition=i;let c=new d.PBRMaterial("".concat(this.reelPosition,"_reel_inner"),e);c.backFaceCulling=!1,c.roughness=0,c.metallic=.15,c.albedoColor=d.Color3.FromHexString("#000000");for(let t=0;t<l;t++){let i=new d.PBRMaterial("".concat(this.reelPosition,"_reel_symbol_").concat(t+1),e);i.albedoColor=new d.Color3(1,1,1),i.albedoTexture=a.clone(),i.transparencyMode=3,i.useAlphaFromAlbedoTexture=!0,i.albedoTexture.hasAlpha=!0,i.bumpTexture=s.clone(),i.bumpTexture.level=.05,i.metallic=0,i.roughness=0,i.indexOfRefraction=1.4,h.push(i)}let u=d.MeshBuilder.CreateCylinder("".concat(this.reelPosition,"_reel"),{height:o,diameter:r,arc:0},e);u.isVisible=!1,u.rotation.y=Math.PI/2,u.rotation.z=Math.PI/4,u.position.y=S.globalReelPositionY,u.position.z=S.globalReelPositionz,u.position.x=t-.03;let m=new d.PBRMaterial("".concat(this.reelPosition,"_reel_background"),e);m.albedoColor=new d.Color3(1,1,1),m.backFaceCulling=!1,m.roughness=.1,m.metallic=.05;let g=d.MeshBuilder.CreateCylinder("".concat(this.reelPosition,"_reel_background"),{height:o,diameter:r-.01,arc:0},e);g.material=m,g.rotation.x=Math.PI/2,g.parent=u;let p=d.MeshBuilder.CreateCylinder("".concat(this.reelPosition,"_inner_reel"),{height:o+.07,diameter:r-.05,arc:0},e);p.material=c,p.rotation.x=Math.PI/2,p.parent=u;for(let t=0;t<l;t++){let a=d.MeshBuilder.CreateCylinder("".concat(this.reelPosition,"_segment_").concat(t+1),{height:o,faceUV:[void 0,f(0,0)],diameter:r,arc:1/l,cap:d.Mesh.NO_CAP},e);a.material=h[t];let s=a.material.albedoTexture,i=a.material.bumpTexture,n=R();s.uOffset=n.x,s.vOffset=n.y,i.uOffset=n.x,i.vOffset=n.y,a.rotation.y=2*Math.PI/l*t,a.parent=g,this.cylinders.push(a),a.hasDisplayed=!1}}}class S{constructor(e,t,a,s){this.winReels=[],this.winReels.push(new N(e,S.globalWinReelWidth+.025,t,a,"left",s)),this.winReels.push(new N(e,0,t,a,"middle",s)),this.winReels.push(new N(e,-(S.globalWinReelWidth+.025),t,a,"right",s))}}S.globalWinReelWidth=.87,S.globalReelSegments=4,S.globalReelDiameter=1.1,S.globalReelPositionY=1.112,S.globalReelPositionz=-1.806;var B=a(5317);class I{build(e,t,a,s,i,n,o){let r=e=>t=>t.name==e;((t,a)=>{let s=e.materials.find(r(t));s?a(s):console.warn("unable to find material"+t)})("chrome",e=>{e.albedoColor=d.Color3.FromHexString("#551414"),e.environmentIntensity=.5,e.clearCoat.isEnabled=!0})}async winAnimation(){await p.ZP.to(this.bulb,{ease:B.Yv.easeInOut,alpha:1,yoyo:!0,repeat:7,duration:.5})}async curtainOpen(){p.ZP.to(this.leftCurtainScale,{ease:B.Yv.easeInOut,x:.003,duration:1}),p.ZP.to(this.rightCurtainScale,{ease:B.Yv.easeInOut,x:.003,duration:1}),p.ZP.to(this.leftCurtainPosition,{ease:B.Yv.easeInOut,x:-4.5,duration:1}),p.ZP.to(this.rightCurtainPosition,{ease:B.Yv.easeInOut,x:4.5,duration:1})}hasWonAnimate(){p.ZP.to(this.glow,{ease:B.Yv.easeInOut,intensity:2.1,yoyo:!0,repeat:-1,duration:1})}async loseAnimation(){await p.ZP.to(this.neons,1,{ease:B.Yv.easeOut,r:.1,g:0,b:0}),await p.ZP.to(this.bulb,1,{ease:B.Yv.easeOut,alpha:0}),p.ZP.to(this.glow,1,{ease:B.Yv.easeOut,intensity:0})}constructor(e){this.isMega=e,this.neons=new d.Color3(.99,.46,.46),this.leftCurtainScale=new d.Vector3(.013,.013,.015),this.rightCurtainScale=new d.Vector3(.013,.013,.015),this.leftCurtainPosition=new d.Vector3(-.39,0,-10.15),this.rightCurtainPosition=new d.Vector3(.905,0,-10.15)}}class L{constructor(e,t,a,s){this.position=s;let i=new d.PBRMaterial(a,e);i.albedoTexture=t,i.metallic=1,i.alpha=0;let n=d.MeshBuilder.CreateBox(a,{wrap:!0});n.material=i,n.metadata=a,n.position=this.position,n.rotation=new d.Vector3(0,Math.PI-.1,0),p.ZP.to(i,1,{ease:B.Yv.easeOut,alpha:1}),p.ZP.to(n.rotation,20,{ease:B.Yv.easeOut,repeat:-1,y:2*Math.PI,yoyo:!0})}}class W{constructor(e,t,a){this.gameCubes=[];let s=a.length>6?6:a.length;for(let i=0;i<s;i++){let s=-.8,n=0;if(i>=3&&(s=.8,n=3),t[i].isCompleted){let o=new L(e,t[i].texture,a[i].gameUrl,new d.Vector3(s,(i-n)*1.1+.4,.1));this.gameCubes.push(o)}}}}class A{constructor(e){let t=new d.HemisphericLight("HemiLight",new d.Vector3(0,1,0),e);t.intensity=2,t.diffuse=new d.Color3(1,1,1);let a=new d.SpotLight("leftLight",new d.Vector3(2.5,3.8,-.4),new d.Vector3(0,-.9,-.4),Math.PI/2,50,e);a.diffuse=new d.Color3(1,.6,.6),a.intensity=500,a.angle=Math.PI/2;let s=new d.SpotLight("rightLight",new d.Vector3(-2.5,3.8,-.4),new d.Vector3(0,-.9,-.4),Math.PI/2,50,e);s.diffuse=new d.Color3(1,.6,.6),s.intensity=500,s.angle=Math.PI/2;let i=new d.SpotLight("centerLight",new d.Vector3(0,3.4,1.6),new d.Vector3(0,-.9,-.4),Math.PI/2,50,e);i.diffuse=new d.Color3(1,1,1),i.intensity=500,i.angle=Math.PI/2}}class E{async loadAssets(){let e=new d.AssetsManager(this.scene);this.assetTasks=new m(e,this.assetBaseUrl,this.config),e.useDefaultLoadingScreen=!1,e.load(),e.onFinish=()=>{this.machineBody=new I(this.config.isMega),this.machineBody.build(this.scene,this.assetTasks.bodyBumpTextureTask.texture,this.assetTasks.bodyBumpNormalTextureTask.texture,this.assetTasks.shadowMapTextureTask.texture,this.assetTasks.floorTextureTask.texture,this.assetTasks.floorNormalTextureTask.texture,this.assetTasks.fabricNormalTextureTask.texture),this.slot=new S(this.scene,this.assetTasks.winReelTextureTask.texture,this.assetTasks.winReelNormalTextureTask.texture,this.config.hasWon),this.handleGameLoadComplete()}}handleGameLoadComplete(){let e=new d.SceneOptimizerOptions(60,500);e.addOptimization(this.hardwareScalingOptimisation),new d.SceneOptimizer(this.scene,e).start(),this.engine.runRenderLoop(()=>this.scene.render()),this.hasWon=!0,this.spin(),this.scene.render()}handleResizer(e){if(this.engine){this.engine.resize();let t=e.height*this.engine.getHardwareScalingLevel(),a=e.width*this.engine.getHardwareScalingLevel();a/t<.6?this.scene.imageProcessingConfiguration.vignetteCameraFov=1.3:a/t<1?this.scene.imageProcessingConfiguration.vignetteCameraFov=.9:this.scene.imageProcessingConfiguration.vignetteCameraFov=.6,a/1.77777777778<t?this.camera.fov=.4:a/t<1.9?this.camera.fov=.42:a/t<2.05?this.camera.fov=.45:a/t<2.2?this.camera.fov=.48:a/t<2.35?this.camera.fov=.5:a/t<2.5?this.camera.fov=.52:a/t<3?this.camera.fov=.6:a/t<3.5?this.camera.fov=.7:a/t<4?this.camera.fov=.8:a/t<5?this.camera.fov=.95:a/t<7?this.camera.fov=1.3:a/t<8?this.camera.fov=1.5:this.camera.fov=1.7}}async spin(){return await Promise.all(this.slot.winReels.map(e=>e.spin())),await this.handleWinReelComplete(),this.hasWon}async handleWinReelComplete(){this.hasWon?(await this.machineBody.winAnimation(),await this.machineBody.curtainOpen(),this.machineBody.hasWonAnimate()):(await this.machineBody.loseAnimation(),this.handleGameLink())}handleGameLink(){this.scene.onPointerDown=()=>{let e=this.scene.createPickingRay(this.scene.pointerX,this.scene.pointerY,d.Matrix.Identity(),this.camera),t=this.scene.pickWithRay(e);t&&t.pickedMesh&&t.pickedMesh.metadata},new W(this.scene,this.assetTasks.gameTileTextureTasks,this.config.recommendedGames)}constructor(e,t,a){this.engine=new d.Engine(e,!0,{preserveDrawingBuffer:!0,stencil:!0},!0),this.assetBaseUrl=t,this.slot=null,this.machineBody=null,this.config=a,this.hasWon=a.hasWon,this.hardwareScalingOptimisation=new d.HardwareScalingOptimization(0,1.5,.25),this.scene=new d.Scene(this.engine),this.scene.createDefaultEnvironment({createGround:!0,createSkybox:!0,toneMappingEnabled:!0,skyboxColor:d.Color3.FromHexString("#ececec"),skyboxSize:25e3,groundColor:d.Color3.FromHexString("#FFFFFF"),groundSize:2e4,groundOpacity:1,enableGroundShadow:!0}),this.scene.ambientColor=d.Color3.FromHexString("#000000"),this.scene.clearColor=d.Color4.FromHexString("#ececec"),this.engine.setHardwareScalingLevel(1),this.hardwareScalingOptimisation=new d.HardwareScalingOptimization(0,1.5,.25),this.scene.gravity=new d.Vector3(0,-.9,0),this.scene.collisionsEnabled=!0,this.scene.getMeshByName("BackgroundPlane").checkCollisions=!0,this.camera=new g(this.scene,e),new A(this.scene),this.loadAssets(),window.addEventListener("resize",()=>this.handleResizer(e)),this.handleResizer(e)}}var D=a(8244),F=a.n(D);class V extends h.Component{componentDidMount(){let e=this.canvasRef.current;e?(console.info("\uD83D\uDC77 Canvas attached"),this.createGame(e,this.gameLaunchConfig)):console.error("Canvas element null")}createGame(e,t){return this.game=new E(e,this.props.assetBaseUrl,t),this.game}render(){return(0,o.jsx)("canvas",{className:F().renderCanvas,ref:this.canvasRef})}constructor(e){super(e),this.game=null,this.canvasRef=h.createRef(),this.gameLaunchConfig={isMega:!1,hasWon:!1,hasSpun:!1,isSpinning:!1,canSpin:!1,infoUrl:"",latestGameName:"",latestGameUrl:"",debug:!1,showToolTip:!0,recommendedGames:[]},this.state=this.gameLaunchConfig}}var Y=()=>(0,o.jsxs)(h.Fragment,{children:[(0,o.jsxs)(l(),{children:[(0,o.jsx)("title",{children:"Matthew Parkin's Portfolio"}),(0,o.jsx)("meta",{name:"description",content:"My portfolio using NextJS and the Babylon JS framework"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,o.jsx)("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Sofia"})]}),(0,o.jsx)("div",{className:u().container,children:(0,o.jsx)(V,{assetBaseUrl:""})}),(0,o.jsx)("section",{className:u().bg_image_1,children:(0,o.jsxs)("div",{className:u().content,children:[(0,o.jsx)("h2",{children:"Matthew Parkins Portfolio "}),(0,o.jsx)("p",{children:"Stay tuned, more interesting stuff coming soon!"})]})})]})},8244:function(e){e.exports={renderCanvas:"GamePage_renderCanvas__XZ2EB"}},6999:function(e){e.exports={container:"index_container__Wxv5N",bg_image_1:"index_bg_image_1__cmMC0",content:"index_content__jnIDP"}}},function(e){e.O(0,[802,68,378,946,324,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);